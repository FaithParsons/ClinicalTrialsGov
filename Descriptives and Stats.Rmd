---
title: "Descriptive Statistics"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(ggplot2)
library(readr)
library(janitor)
library(stringr)
library(tidyverse)

```

```{r read data, include = FALSE}

results = read_csv("Data/SearchResultsTable.csv") %>%
  clean_names() 

# Create dataset for descriptives for clinical trials in the US
us_studies = results %>%
  # Filter only studies that have sites in the United States
  filter(str_detect(locations, "United States"))  %>%
         # Count number of locations, interventions, and funders
  mutate(num_locs = as.numeric(str_count(locations, "\\|")) + 1,
         num_intervs = as.numeric(str_count(interventions, "\\|")) + 1,
         num_funders = as.numeric(str_count(funded_bys, "\\|")) + 1,
         # Dummy for Funded by - "Industry"
         fundby_industry = ifelse(str_detect(funded_bys, "Industry") == TRUE, 1, 0),
         # dummy for Funded by - "NIH"
         fundby_nih = ifelse(str_detect(funded_bys, "NIH") == TRUE, 1, 0),
         # dummy for FUnded by - "U.S. Fed"
         fundby_usfed = ifelse(str_detect(funded_bys, "U.S. Fed") == TRUE, 1, 0),
         # dummy for Funded by - "Other")
         fundby_other = ifelse(str_detect(funded_bys, "Other") == TRUE, 1, 0),
         # Intervention Types -- Dummy Variables
         interv_drug =  ifelse(str_detect(interventions, "Drug:") == TRUE, 1, 0), 
         interv_behav = ifelse(str_detect(interventions, "Behavioral:") == TRUE, 1, 0),
         interv_biol  = ifelse(str_detect(interventions, "Biological:") == TRUE, 1, 0), 
         interv_diag  = ifelse(str_detect(interventions, "Diagnostic Test:") == TRUE, 1, 0) ,
         interv_device = ifelse(str_detect(interventions, "Device:") == TRUE, 1, 0),
         interv_rad   = ifelse(str_detect(interventions, "Radiation:") == TRUE, 1, 0),
         interv_diet  = ifelse(str_detect(interventions, "Dietary Supplement:") == TRUE, 1, 0),
         interv_gene  = ifelse(str_detect(interventions, "Genetic:") == TRUE, 1, 0),
         interv_proc  = ifelse(str_detect(interventions, "Procedure:") == TRUE, 1, 0),
         interv_other = ifelse(str_detect(interventions, "Other:") == TRUE, 1, 0))
  
# This data contains the variable on number of US Sites 
num_ussites = readRDS("Data/num_ussites.rds")
  


```

```{r descriptives}


```

### Study Characteristics (DRAFT)

The original dataset contained  **`r format(nrow(results), nsmall = 1, big.mark = ",")` records** corresponding to all studies on Alzheimer's Disease registered at the [ClinicalTrials.gov website](http://clinicaltrials.gov) with study start dates from `r results %>% pull(start_date) %>% min()` to `r results %>% pull(start_date) %>% max()`. We restricted our analysis dataset to the **`r nrow(us_studies)`** studies with study sites in the United States.

The number of study sites within the United States ranged from `r min(num_ussites$num_ussites)` to `r max(num_ussites$num_ussites)`.

The distribution of study phases is found in Figure1, and the distribution of the number of interventions are in Figure2.

```{r ggplot phase and number of interventions}

us_studies %>% 
  group_by(phases) %>%
  summarize(n = n()) %>%
  ggplot(aes(x = phases, y = n)) +
    geom_col() 

us_studies %>%
  ggplot(aes(x = num_intervs)) +
    geom_histogram(bins = 5)
```


 
